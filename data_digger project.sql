CREATE DATABASE PROJECT_one;
USE PROJECT_one;

-- =========================
-- CLIENT TABLE
-- =========================
CREATE TABLE CLIENT (
CLIENT_ID INT PRIMARY KEY,
FULL_NAME VARCHAR(25) NOT NULL,
CONTACT_EMAIL VARCHAR(40) NOT NULL,
CITY VARCHAR(60) NOT NULL
);

INSERT INTO CLIENT (CLIENT_ID, FULL_NAME, CONTACT_EMAIL, CITY)
VALUES
(11, 'Arjun Verma', 'arjun@demo.com', 'Jaipur'),
(12, 'Sneha Iyer', 'sneha@demo.com', 'Chennai'),
(13, 'Rohit Malhotra', 'rohit@demo.com', 'Delhi'),
(14, 'Kavya Nair', 'kavya@demo.com', 'Kochi'),
(15, 'Manish Gupta', 'manish@demo.com', 'Bhopal'),
(16, 'Anita Kulkarni', 'anita@demo.com', 'Pune'),
(17, 'Vikas Singh', 'vikas@demo.com', 'Lucknow'),
(18, 'Nisha Roy', 'nisha@demo.com', 'Kolkata');

SELECT * FROM CLIENT;

UPDATE CLIENT
SET CITY = 'Indore'
WHERE CLIENT_ID = 16;

DELETE FROM CLIENT
WHERE CLIENT_ID = 15;

SELECT * FROM CLIENT
WHERE FULL_NAME = 'Arjun Verma';

-- =========================
-- SALES ORDER TABLE
-- =========================
CREATE TABLE SALES_ORDER (
SO_ID INT PRIMARY KEY,
CLIENT_ID INT,
ORDER_DATE DATE NOT NULL,
TOTAL_PRICE DECIMAL(10,2)
);

INSERT INTO SALES_ORDER (SO_ID, CLIENT_ID, ORDER_DATE, TOTAL_PRICE)
VALUES
(201, 11, '2024-02-01', 4200),
(202, 12, '2024-02-03', 3100),
(203, 13, '2024-02-05', 5600),
(204, 14, '2024-02-07', 2300),
(205, 16, '2024-02-10', 4800);

SELECT SUM(TOTAL_PRICE) AS GRAND_TOTAL
FROM SALES_ORDER;

SELECT MAX(TOTAL_PRICE) AS HIGHEST_ORDER
FROM SALES_ORDER;

SELECT MIN(TOTAL_PRICE) AS LOWEST_ORDER
FROM SALES_ORDER;

SELECT AVG(TOTAL_PRICE) AS AVERAGE_ORDER
FROM SALES_ORDER;

-- =========================
-- ITEM TABLE
-- =========================
CREATE TABLE ITEM (
ITEM_ID INT PRIMARY KEY,
ITEM_NAME VARCHAR(50),
COST INT,
AVAILABLE_STOCK INT
);

INSERT INTO ITEM (ITEM_ID, ITEM_NAME, COST, AVAILABLE_STOCK)
VALUES
(1, 'Tablet', 22000, 6),
(2, 'Headphones', 2500, 15),
(3, 'Charger', 900, 0),
(4, 'Smartwatch', 7000, 8),
(5, 'Speaker', 4500, 4);

SELECT * FROM ITEM
ORDER BY COST DESC;

UPDATE ITEM
SET COST = 6800
WHERE ITEM_ID = 4;

DELETE FROM ITEM
WHERE AVAILABLE_STOCK = 0;

SELECT *
FROM ITEM
WHERE COST BETWEEN 2000 AND 8000;

SELECT 
MAX(COST) AS COSTLIEST,
MIN(COST) AS CHEAPEST
FROM ITEM;

-- =========================
-- ORDER LINE TABLE
-- =========================
CREATE TABLE ORDER_LINE (
LINE_ID INT PRIMARY KEY,
SO_ID INT,
ITEM_ID INT,
QTY INT,
LINE_TOTAL DECIMAL(10,2)
);

INSERT INTO ORDER_LINE (LINE_ID, SO_ID, ITEM_ID, QTY, LINE_TOTAL)
VALUES
(1, 201, 1, 1, 22000),
(2, 201, 2, 2, 5000),
(3, 202, 4, 1, 7000),
(4, 203, 5, 2, 9000),
(5, 204, 2, 1, 2500);

SELECT LINE_ID
FROM ORDER_LINE
WHERE SO_ID = 202;

SELECT SUM(LINE_TOTAL) AS TOTAL_REVENUE
FROM ORDER_LINE;

SELECT ITEM_ID, SUM(QTY) AS MOST_SOLD
FROM ORDER_LINE
GROUP BY ITEM_ID
ORDER BY MOST_SOLD DESC
LIMIT 3;

SELECT COUNT(*) AS SOLD_TIMES
FROM ORDER_LINE
WHERE ITEM_ID = 2;
